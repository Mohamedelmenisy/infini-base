<!DOCTYPE html>
<html lang="en" dir="ltr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfiniBase - Editable Scenario</title>
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32'><rect width='32' height='32' rx='4' fill='%236366f1'/><text x='50%' y='55%' dominant-baseline='middle' text-anchor='middle' font-family='Arial, sans-serif' font-size='18' font-weight='bold' fill='white'>IB</text></svg>">
    
    <!-- CDNs -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

    <style>
        :root {
            /* --- تصميم Dark Theme من ملف baaase.txt --- */
            --primary-color: #6366f1;
            --primary-color-hover: #4f46e5;
            --text-color: #d1d5db;
            --text-color-muted: #9ca3af;
            --text-color-inverted: #ffffff;
            --text-color-subtle: #9ca3af;
            --bg-color: #111827;
            --bg-color-alt: #1f2937;
            --bg-color-hover: #374151;
            --border-color: #374151;
            --border-color-darker: #4b5563;
            --card-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            --border-radius: 0.5rem;
            --border-radius-lg: 0.75rem;
            --header-height: 70px;
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .content-wrapper {
            max-width: 900px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        .content-header {
            padding: 1.25rem 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
        }
        
        #currentSectionTitle {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0;
        }

        #breadcrumbs {
            font-size: 0.875rem;
            color: var(--text-color-muted);
            margin-top: 0.25rem;
        }
        #breadcrumbs a { color: var(--primary-color); text-decoration: none; }
        #breadcrumbs a:hover { text-decoration: underline; }

        .card {
            background-color: var(--bg-color-alt);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            box-shadow: var(--card-shadow);
        }

        /* --- Styles for Quill Editor and Content --- */
        .ql-toolbar {
            background: var(--bg-color);
            border-color: var(--border-color-darker) !important;
            border-top-left-radius: var(--border-radius);
            border-top-right-radius: var(--border-radius);
        }
        .ql-toolbar .ql-stroke { stroke: var(--text-color-muted); }
        .ql-toolbar .ql-fill { fill: var(--text-color-muted); }
        .ql-toolbar .ql-picker-label { color: var(--text-color-muted); }
        
        .ql-container {
            border-color: var(--border-color-darker) !important;
            color: var(--text-color);
            font-size: 1rem;
            border-bottom-left-radius: var(--border-radius);
            border-bottom-right-radius: var(--border-radius);
            background-color: var(--bg-color-alt);
        }
        
        /* --- Styles for Content Elements inside Quill --- */
        .ql-editor h3 {
            margin-top: 1.5em;
            margin-bottom: 0.75em;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--text-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.5rem;
        }
        .ql-editor p { margin-bottom: 1em; }
        .ql-editor ul, .ql-editor ol { margin-bottom: 1em; padding-left: 20px; }
        .ql-editor li { margin-bottom: 0.5em; }
        .ql-editor blockquote {
            background-color: var(--bg-color);
            padding: 0.75rem 1rem;
            border-radius: var(--border-radius);
            margin: 1em 0;
            border-left: 4px solid var(--primary-color);
            color: var(--text-color);
        }
        .compensation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }
        .compensation-box {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color-darker);
            padding: 1.5rem;
            border-radius: var(--border-radius-lg);
        }
        .compensation-box h4 {
            margin-top: 0;
            font-size: 1.1rem;
            font-weight: 600;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.75rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .compensation-box.fast-order h4 { color: #f59e0b; }
        .compensation-box.scheduled-order h4 { color: #38bdf8; }
        .compensation-box ul { list-style: none; padding: 0; margin: 0; }
        .compensation-box ul li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem 0;
            font-size: 0.9rem;
            border-bottom: 1px solid var(--border-color);
        }
        .compensation-box ul li:last-child { border-bottom: none; }
        .compensation-box ul li span:first-child { font-weight: 500; color: var(--text-color-subtle); }
        .compensation-box ul li .action { font-weight: 600; text-align: right; }

        footer {
            text-align: center;
            padding: 1.5rem;
            font-size: 0.875rem;
            color: var(--text-color-muted);
            border-top: 1px solid var(--border-color);
            margin-top: 2rem;
        }
    </style>
</head>
<body>

    <div class="content-wrapper">
        <header class="content-header">
            <div>
                <h1 id="currentSectionTitle">Customer Compensation Flow</h1>
                <div id="breadcrumbs">
                    <a href="#">Home</a> › <a href="#">Support</a> › Editable Scenario
                </div>
            </div>
        </header>

        <main>
            <div class="card">
                <!-- Quill Editor Container -->
                <div id="editor"></div>

                <!-- Last Updated Date Display -->
                <div id="lastUpdated" style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--border-color); font-size: 0.875rem; color: var(--text-color-muted); text-align: right;">
                  Last updated on: Never
                </div>
            </div>
        </main>

        <footer>
            <span>© 2024 InfiniBase.Elmenisy.</span>
        </footer>
    </div>

<script>
    // 1. تعريف محتوى السيناريو (مأخوذ من ملف baaase.txt)
    const scenarioContent = `
        <h3><i class="fas fa-book-open"></i> Introduction: Understanding the Compensation Policy</h3>
        <p>This article provides a comprehensive guide for support agents on handling customer inquiries related to order delays and potential compensation. The goal is to resolve customer issues efficiently while adhering to The Chefz's quality standards and compensation matrix. A positive and empathetic approach is key to customer retention.</p>
        
        <h3><i class="fas fa-headset"></i> Initial Contact and Inquiry Identification</h3>
        <p>When a customer contacts support regarding a late order, the first step is to acknowledge their concern and verify the order details.</p>
        <blockquote>
            <i class="fas fa-comment-dots"></i> "Hello, thank you for contacting The Chefz. My name is [Your Name]. I understand you're calling about a delay with your order. Could you please provide me with your order number so I can look into it for you?"
        </blockquote>
        
        <h3><i class="fas fa-clock"></i> Assessing the Delay and Order Type</h3>
        <p>Using the company system, determine the exact duration of the delay against the estimated delivery time (ETA). It's crucial to identify if the order is a <strong>Fast Order</strong> or a <strong>Scheduled Order</strong>, as compensation policies differ.</p>
        
        <h3><i class="fas fa-calculator"></i> Applying the Compensation Matrix</h3>
        <p>Based on the delay duration and order type, apply the official compensation policy. Agent discretion may be used within the defined limits.</p>
        <div class="compensation-grid">
            <div class="compensation-box fast-order">
                <h4><i class="fas fa-shipping-fast"></i> Fast Orders (> 15 mins)</h4>
                <ul>
                    <li><span>16–30 mins</span> <span class="action">Delivery Fees</span></li>
                    <li><span>31–45 mins</span> <span class="action">Fees + 25% Chef Total</span></li>
                    <li><span>46–60 mins</span> <span class="action">Fees + 50% Chef Total</span></li>
                    <li><span>> 60 mins</span> <span class="action">Total Order</span></li>
                </ul>
            </div>
            <div class="compensation-box scheduled-order">
                <h4><i class="fas fa-calendar-alt"></i> Scheduled Orders (> 30 mins)</h4>
                <ul>
                    <li><span>31–60 mins</span> <span class="action">50-100% of Total Order</span></li>
                    <li><span>> 60 mins</span> <span class="action">Total Order + 50 SAR</span></li>
                </ul>
            </div>
        </div>
        <blockquote>
            <i class="fas fa-comment-dots"></i> "Based on the [duration] delay with your [Fast/Scheduled] order, we will be processing a compensation of [state specific compensation]. This will be reflected in your account within 24-48 hours. We are very sorry for the inconvenience this has caused."
        </blockquote>

        <h3><i class="fas fa-clipboard-check"></i> Finalizing the Case & Documentation</h3>
        <p>The agent must finalize the action directly in the company system by logging the note on the order, recording the compensation amount, and selecting the responsible party (Store, Driver, Company).</p>
    `;

    // 2. إعداد محرر Quill
    const quill = new Quill('#editor', {
        theme: 'snow',
        modules: {
            toolbar: [
                [{ 'header': [1, 2, 3, false] }],
                ['bold', 'italic', 'underline', 'strike'],
                [{'list': 'ordered'}, {'list': 'bullet'}],
                ['link', 'image', 'blockquote'],
                ['clean']
            ]
        },
        placeholder: 'Start editing the scenario here...'
    });

    // 3. تحميل المحتوى داخل المحرر
    quill.root.innerHTML = scenarioContent;

    // 4. إعداد وظيفة تحديث التاريخ
    const lastUpdatedElement = document.getElementById('lastUpdated');

    function updateLastUpdatedDate() {
        const now = new Date();
        const formattedDate = now.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
        lastUpdatedElement.textContent = 'Last updated on: ' + formattedDate;
    }

    // 5. ربط وظيفة التحديث بحدث التعديل في المحرر
    quill.on('text-change', function(delta, oldDelta, source) {
        // يتم التحديث فقط إذا كان التغيير من المستخدم
        if (source === 'user') {
            updateLastUpdatedDate();
        }
    });

    // 6. عرض التاريخ الأولي عند تحميل الصفحة
    // سنستخدم التاريخ من البيانات الأصلية كقيمة ابتدائية
    const initialDate = new Date('2025-06-22T14:30:00.000Z');
    lastUpdatedElement.textContent = 'Last updated on: ' + initialDate.toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });

</script>
</body>
</html>
